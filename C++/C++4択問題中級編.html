<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C++ 4択問題 中級編</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .options label.disabled {
      pointer-events: none;
      color: #000;
    }
  </style>
</head>
<body>
  <div class="quiz-container" id="home">
    <h1>C++ 4択クイズ 中級編</h1>
    <p>全10問です。</p>
    <button onclick="startQuiz()">開始</button>
    <a href="C++.html" class="back-button">問題選択に戻る</a>
  </div>

  <div class="quiz-container" id="quiz" style="display: none;"></div>

  <script>
    const questions = [
      {
        q: `以下のコードの出力は？<pre>int a = 10;\nint b = 3;\ncout << double(a / b) << endl;</pre>`,
        options: [
          "A. 3.33333",
          "B. 3",
          "C. 3.0",
          "D. エラーになる"
        ],
        answer: 2,
        explanation: "a / b はどっちも int だから 整数の割り算 → 結果は 3。それを double(3) にするので 3.0 が出力される。"
      },
      {
        q: `以下のコードの出力は？<pre>int a = 10;\nint b = 3;\ncout << (double)a / b << endl;</pre>`,
        options: [
          "A. 3.33333",
          "B. 3",
          "C. 3.0",
          "D. エラーになる"
        ],
        answer: 0,
        explanation: "(double)a で先に 10 が 10.0 になる → 10.0 / 3 は 実数の割り算になるので 3.33333...。"
      },
      {
        q: `以下のコードの出力は？<pre>int x = 10;\n{\n  int x = 5;\n  cout << x << endl;\n}\ncout << x << endl;</pre>`,
        options: [
          "A. 5 5",
          "B. 5 10",
          "C. 10 5",
          "D. エラーになる"
        ],
        answer: 1,
        explanation: "ブロック内の int x = 5; は外側の x を隠してる（シャドウイング） → ブロック内: 5、ブロック外: 10。"
      },
      {
        q: `このコードを実行しても x の値が変わらないのはなぜ？<pre>void addTen(int x) {\n  x += 10;\n}\n\nint main() {\n  int x = 5;\n  addTen(x);\n  cout << x << endl;\n  return 0;\n}</pre>`,
        options: [
          "A. 関数が呼ばれていないから",
          "B. 値渡しなので x の変更が反映されない",
          "C. 10 を足す処理が間違っている",
          "D. cout の位置が悪い"
        ],
        answer: 1,
        explanation: "関数引数に int x と書くと、元の値のコピーになる（値渡し） → 関数内で x を変えても、main の x には影響なし。"
      },
      {
        q: "以下のコードの出力は？<pre>int i = 0;\nwhile (i != 10) {\n  i += 3;\n  cout << i << endl;\n}</pre>",
        options: [
          "A. TLEになる（無限ループ）",
          "B. エラーになる",
          "C. 3の倍数が表示される",
          "D. 10までの数字が表示される"
        ],
        answer: 0,
        explanation: "このコードではwhile文から抜けることができないので無限ループとなりTLEする。"
      },
      {
        q: "このコードが無限ループになる理由は？<pre>int i = 0;\nwhile (i != 10) {\n  i += 3;\n  cout << i << endl;\n}</pre>",
        options: [
          "A. i は10にならないから",
          "B. while文の条件が間違っているから",
          "C. += の書き方が間違っているから",
          "D. ループの中で i が減少してるから"
        ],
        answer: 0,
        explanation: "i は 0 → 3 → 6 → 9 → 12 というふうに 10 を飛び越えてしまうため、`i != 10` を永遠に満たしてしまう。"
      },
      {
        q: "次のコードを実行したとき、何回 '1' と出力されるか？<pre>int main() {\n  for (int i = 0; i < 3; i++) {\n    for (int j = 0; j < 3; j++) {\n      if (i == j) break;\n      cout << 1 << endl;\n    }\n  }\n  return 0;\n}</pre>",
        options: [
          "3回",
          "4回",
          "5回",
          "6回"
        ],
        answer: 0,
        explanation: "内側のループは i == j の時に break で抜けるため、i < jになることはない。よって(i, j) = (1, 0) 、(2, 0) 、(2, 1)のときに 1 が出力される。よって出力される回数は3回。"
      },
{
  q: "次の再帰関数を実行したとき、出力される値は何か？<pre>void func(int n) {\n  if (n == 0) return;\n  cout << n << ' ';\n  func(n - 1);\n}\nint main() {\n  func(3);\n  return 0;\n}</pre>",
  options: [
    "3 2 1",
    "3 2 1 0",
    "1 2 3",
    "0 1 2 3"
  ],
  answer: 0,
  explanation: "再帰関数 func(3) は n が0になるまで再帰呼び出しを行い、呼び出しの順番は 3 2 1 となる。最後に `n == 0` で終了するので、3 2 1 が出力される。"
},
{
  q: "次のコードを実行したとき、b の値は何になるか？<pre>int a = 5;\nint& b = a;\na = 10;\ncout << b << endl;</pre>",
  options: [
    "5",
    "10",
    "エラーになる",
    "未定義"
  ],
  answer: 1,
  explanation: "bはaの参照であるため、aを変更するとbも同じ値を参照することになります。従って、bの値は10になります。"
},
{
  q: "次のコードを実行したとき、c の値は何になるか？<pre>int a = 5;\nint& b = a;\nint& c = b;\na = 10;\ncout << c << endl;</pre>",
  options: [
    "5",
    "10",
    "エラーになる",
    "未定義"
  ],
  answer: 1,
  explanation: "bはaの参照で、cはbの参照である。したがって、aを10に変更すると、bが10となる。bが10になったのでcも10となる。"
},

    ];

    let current = 0;
    const homeEl = document.getElementById("home");
    const quizEl = document.getElementById("quiz");

    function startQuiz() {
      current = 0;
      homeEl.style.display = "none";
      quizEl.style.display = "block";
      showQuestion(current);
    }

    function showQuestion(index) {
      quizEl.innerHTML = "";
      const q = questions[index];

      const container = document.createElement("div");
      container.className = "question";

      const title = document.createElement("div");
      title.innerHTML = `<strong>Q${index + 1}:</strong> ${q.q}`;
      container.appendChild(title);

      const options = document.createElement("div");
      options.className = "options";

      q.options.forEach((opt, i) => {
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `q${index}`;
        input.value = i;
        label.appendChild(input);
        label.appendChild(document.createTextNode(" " + opt));
        options.appendChild(label);
      });

      container.appendChild(options);

      const button = document.createElement("button");
      button.textContent = "解答";

      const result = document.createElement("div");
      result.className = "result";

      const explanation = document.createElement("div");
      explanation.className = "explanation";

      const backButton = document.createElement("a");
      backButton.href = "C++.html";
      backButton.className = "home-button";
      backButton.textContent = "問題選択に戻る";

      const nextButton = document.createElement("button");
      nextButton.textContent = "次へ";
      nextButton.style.display = "none";
      nextButton.style.margin = "20px auto";
      nextButton.onclick = () => {
        current++;
        if (current < questions.length) {
          showQuestion(current);
        } else {
          quizEl.innerHTML = `<h2>お疲れ様でした！全${questions.length}問が終了しました。</h2>`;
          quizEl.appendChild(backButton);
        }
      };

      const nextButtonWrapper = document.createElement("div");
      nextButtonWrapper.style.textAlign = "center";
      nextButtonWrapper.appendChild(nextButton);

      button.onclick = () => {
        const selected = container.querySelector("input:checked");
        if (!selected) {
          result.textContent = "選択肢を選んでください。";
          result.style.color = "black";
          return;
        }

        const isCorrect = parseInt(selected.value) === q.answer;
        result.textContent = isCorrect ? "○ 正解です！" : `× 不正解です。正解：${q.options[q.answer]}`;
        result.style.color = isCorrect ? "green" : "red";
        explanation.textContent = q.explanation;

        const labels = container.querySelectorAll("label");
        labels.forEach(label => label.classList.add("disabled"));

        button.style.display = "none";
        nextButton.style.display = "inline-block";
      };

      container.appendChild(button);
      container.appendChild(result);
      container.appendChild(explanation);
      container.appendChild(nextButtonWrapper);
      container.appendChild(backButton);

      quizEl.appendChild(container);
    }
  </script>
</body>
</html>
