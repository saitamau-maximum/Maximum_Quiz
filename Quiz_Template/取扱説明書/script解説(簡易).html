<script>
    
ãƒ»const RANKING_KEY
      ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹éš›ã®ã‚­ãƒ¼åã€‚
    
    const RANKING_KEY = "cpp_select_quiz_ranking_easy";

ãƒ»const questions
      ã‚¯ã‚¤ã‚ºã®å•é¡Œã€é¸æŠè‚¢ã€æ­£è§£ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€è§£èª¬ã‚’æ ¼ç´ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã€‚
       q - å•é¡Œæ–‡
       options - 4ã¤ã®é¸æŠè‚¢
       answer - æ­£è§£ã®é¸æŠè‚¢ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (0ã‹ã‚‰å§‹ã¾ã‚‹)
       explanation - æ­£è§£ã®è§£èª¬æ–‡
     

ãƒ»function shuffle
      é…åˆ—ã®è¦ç´ ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆã‚‹ï¼ˆãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼â€“ã‚¤ã‚§ãƒ¼ãƒ„ã®ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼‰ã€‚
      array - ä¸¦ã³æ›¿ãˆã‚‹å¯¾è±¡ã®é…åˆ—

    function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

ãƒ»let current
      ç¾åœ¨è¡¨ç¤ºã—ã¦ã„ã‚‹å•é¡Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆä½•å•ç›®ã‹ï¼‰ã‚’ç®¡ç†ã™ã‚‹å¤‰æ•°ã€‚


ãƒ»let score
      ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ­£è§£æ•°ã‚’è¨˜éŒ²ã™ã‚‹å¤‰æ•°ã€‚
    

ãƒ»let backClickCount
      ã€Œå•é¡Œé¸æŠã«æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®èª¤æ“ä½œã‚’é˜²ããŸã‚ã®ã‚¯ãƒªãƒƒã‚¯å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ã€‚
  

ãƒ»backButtonHome
      ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚ã‚‹ã€Œå•é¡Œé¸æŠã«æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®HTMLè¦ç´ ã€‚

    const backButtonHome = document.querySelector(".back-button");
    if (backButtonHome) {
      // ã€Œæˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      backButtonHome.addEventListener("click", function(e) {
        e.preventDefault(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒªãƒ³ã‚¯é·ç§»ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        if (backClickCount === 0) {
          alert("æœ¬å½“ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨æˆ»ã‚Šã¾ã™ã€‚");
          backClickCount++;
        } else {
          window.location.href = "C++.html"; // 2å›ç›®ã®ã‚¯ãƒªãƒƒã‚¯ã§ãƒšãƒ¼ã‚¸é·ç§»
        }
      });
    }

ãƒ»homeEl
      ã‚¯ã‚¤ã‚ºã®ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ï¼ˆãƒ›ãƒ¼ãƒ ï¼‰ã®ã‚³ãƒ³ãƒ†ãƒŠè¦ç´ ã€‚

    const homeEl = document.getElementById("home");

ãƒ»quizEl
      ã‚¯ã‚¤ã‚ºã®å•é¡ŒãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒŠè¦ç´ ã€‚

    const quizEl = document.getElementById("quiz");

ãƒ»function startQuiz
      ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹é–¢æ•°ã€‚3ç§’ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³å¾Œã€ã‚¯ã‚¤ã‚ºç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

    function startQuiz() {
      // é–‹å§‹ãƒœã‚¿ãƒ³ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–ã™ã‚‹
      const startButton = homeEl.querySelector("button");
      startButton.disabled = true;

      // é–‹å§‹åŠ¹æœéŸ³ã‚’å†ç”Ÿ
      const seStart = document.getElementById('se-start');
      seStart.currentTime = 0;
      seStart.play();
      
      // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºç”¨ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¨ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã‚’å–å¾—
      const countdownOverlay = document.getElementById('countdown-overlay');
      const countdownText = document.getElementById('countdown-text');

      countdownOverlay.style.display = 'flex';// ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’è¡¨ç¤º 
      
      let count = 3;// ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã®åˆæœŸå€¤
      countdownText.textContent = count;

      // 1ç§’ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¤ãƒãƒ¼
      const countdownTimer = setInterval(() => {
        count--;
        if (count > 0) {
          countdownText.textContent = count;
        } else {
          countdownText.textContent = 'START!';
        }
      }, 1000);

      // 3.5ç§’å¾Œã«ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹
      setTimeout(() => {
        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢
        clearInterval(countdownTimer);
         // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’éè¡¨ç¤º
        countdownOverlay.style.display = 'none';

        // BGMãŒå†ç”Ÿã•ã‚Œã¦ã„ãªã„å ´åˆã€å†ç”Ÿã‚’é–‹å§‹ã™ã‚‹
        if(bgmToggleBtn.textContent == "â–¶ï¸ BGMã‚’å†ç”Ÿ") {
          document.getElementById('bgm').play();
          bgmToggleBtn.textContent = 'â¸ï¸ BGMã‚’åœæ­¢';
        }

        shuffle(questions);// å•é¡Œã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
        current = 0;// ç¾åœ¨ã®å•é¡Œã‚’ãƒªã‚»ãƒƒãƒˆ
        score = 0;// ã‚¹ã‚³ã‚¢ã‚’ãƒªã‚»ãƒƒãƒˆ
        homeEl.style.display = "none"; // ãƒ›ãƒ¼ãƒ ç”»é¢ã‚’éè¡¨ç¤º
        quizEl.style.display = "block"; // ã‚¯ã‚¤ã‚ºç”»é¢ã‚’è¡¨ç¤º
        showQuestion(current); // æœ€åˆã®å•é¡Œã‚’è¡¨ç¤º
        startButton.disabled = false; // é–‹å§‹ãƒœã‚¿ãƒ³ã‚’å†åº¦æœ‰åŠ¹åŒ–
      }, 3500);
    }


ãƒ»function showQuestion
        æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å•é¡Œã¨é¸æŠè‚¢ã‚’ç”»é¢ã«æç”»ã™ã‚‹é–¢æ•°ã€‚
        index - è¡¨ç¤ºã™ã‚‹å•é¡Œã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (`questions`é…åˆ—ã«å¯¾å¿œ)

    function showQuestion(index) {
      quizEl.innerHTML = ""; // å‰ã®å•é¡Œã‚’ã‚¯ãƒªã‚¢
      const q = questions[index]; // ç¾åœ¨ã®å•é¡Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—

      // å•é¡Œã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
      const container = document.createElement("div");
      container.className = "question";

      // å•é¡Œæ–‡ã‚’ä½œæˆã—ã¦è¿½åŠ 
      const title = document.createElement("div");
      title.innerHTML = `<strong>Q${index + 1}:</strong> ${q.q}`;
      container.appendChild(title);

      // é¸æŠè‚¢ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
      const options = document.createElement("div");
      options.className = "options";

      // å„é¸æŠè‚¢ã‚’ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ã—ã¦ä½œæˆ
      q.options.forEach((opt, i) => {
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `q${index}`;
        input.value = i;
        label.appendChild(input);
        label.appendChild(document.createTextNode(" " + opt));
        options.appendChild(label);
      });
      container.appendChild(options);

      // ã€Œè§£ç­”ã€ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
      const button = document.createElement("button");
      button.textContent = "è§£ç­”";

      // çµæœè¡¨ç¤ºç”¨ã®è¦ç´ ã‚’ä½œæˆ
      const result = document.createElement("div");
      result.className = "result";

      // è§£èª¬è¡¨ç¤ºç”¨ã®è¦ç´ ã‚’ä½œæˆ
      const explanation = document.createElement("div");
      explanation.className = "explanation";

      // ã€Œå•é¡Œé¸æŠã«æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
      const backButton = document.createElement("a");
      backButton.href = "C++.html";
      backButton.className = "home-button";
      backButton.textContent = "å•é¡Œé¸æŠã«æˆ»ã‚‹";
      
      // ã€Œæˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®èª¤æ“ä½œé˜²æ­¢ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      backButton.addEventListener("click", function(e) {
        e.preventDefault();
        if (backClickCount === 0) {
          alert("æœ¬å½“ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨æˆ»ã‚Šã¾ã™ã€‚");
          backClickCount++;
        } else {
          window.location.href = "C++.html";
        }
      });

      // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
      const nextButton = document.createElement("button");
      nextButton.textContent = "æ¬¡ã¸";
      nextButton.style.display = "none"; // åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º
      nextButton.style.margin = "20px auto";
      
  
      //ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®å‡¦ç†ã€‚
      // æ¬¡ã®å•é¡Œã«é€²ã‚€ã‹ã€å…¨å•çµ‚äº†ã—ã¦ã„ãŸã‚‰çµæœç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
      
      nextButton.onclick = () => {
        setTimeout(() => {
          current++; // æ¬¡ã®å•é¡Œã¸
          backClickCount = 0; // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
          if (current < questions.length) {
            showQuestion(current); // æ¬¡ã®å•é¡Œã‚’è¡¨ç¤º
          } else {
            // --- å…¨å•çµ‚äº†æ™‚ã®å‡¦ç† ---
            const seEnd = document.getElementById('se-end');
            seEnd.currentTime = 0;
            seEnd.play(); // çµ‚äº†åŠ¹æœéŸ³
            backClickCount = 1; // çµæœç”»é¢ã§ã¯ã€Œæˆ»ã‚‹ã€ã‚’1ã‚¯ãƒªãƒƒã‚¯ã§æœ‰åŠ¹ã«ã™ã‚‹
            quizEl.innerHTML = ""; // ç”»é¢ã‚’ã‚¯ãƒªã‚¢

            // çµæœè¡¨ç¤º
            const container = document.createElement("div");
            quizEl.innerHTML = `<h2>ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼å…¨${questions.length}å•ãŒçµ‚äº†ã—ã¾ã—ãŸã€‚<br><br>${score}å•æ­£è§£ã—ã¾ã—ãŸï¼</h2>`;
            
            // --- ãƒ©ãƒ³ã‚­ãƒ³ã‚°å‡¦ç† ---
            const today = new Date().toLocaleString(); // ç¾åœ¨æ—¥æ™‚ã‚’å–å¾—
            const newRecord = { date: today, score: score }; // æ–°ã—ã„è¨˜éŒ²ã‚’ä½œæˆ

            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰æ—¢å­˜ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å–å¾—
            let ranking = JSON.parse(localStorage.getItem(RANKING_KEY) || "[]");
            ranking.push(newRecord); // æ–°ã—ã„è¨˜éŒ²ã‚’è¿½åŠ 

            // ã‚¹ã‚³ã‚¢ã®é«˜ã„é †ã«ã‚½ãƒ¼ãƒˆã—ã€ä¸Šä½5ä»¶ã«çµã‚‹
            ranking.sort((a, b) => b.score - a.score);
            ranking = ranking.slice(0, 5);

            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            localStorage.setItem(RANKING_KEY, JSON.stringify(ranking));

            // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ç”»é¢ã«è¡¨ç¤º
            const rankingList = document.createElement("div");
            rankingList.innerHTML = "<h3>ğŸ†æ­£è§£æ•°ãƒ©ãƒ³ã‚­ãƒ³ã‚°(ãƒ­ãƒ¼ã‚«ãƒ«)</h3>";
            ranking.forEach((r, i) => {
              rankingList.innerHTML += `${i + 1}ä½: ${r.score}ç‚¹ï¼ˆ${r.date}ï¼‰<br>`;
            });

            // ã€Œæœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™ã€ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
            const retryBtn = document.createElement("button");
            retryBtn.textContent = "æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™";
            retryBtn.onclick = () => {
              startQuiz(); // ã‚¯ã‚¤ã‚ºã‚’å†é–‹
            };

            let resetClickCount = 0; // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã®èª¤æ“ä½œé˜²æ­¢ã‚«ã‚¦ãƒ³ã‚¿

            // ã€Œãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
            const resetBtn = document.createElement("button");
            resetBtn.textContent = "ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ";
            resetBtn.onclick = () => {
              if (resetClickCount === 0) {
                alert("æœ¬å½“ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚");
                resetClickCount++;
              } else {
                localStorage.removeItem(RANKING_KEY); // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
                location.reload(); // ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦åæ˜ 
              }
            };

            // å„è¦ç´ ã‚’ç”»é¢ã«è¿½åŠ 
            quizEl.appendChild(backButton);
            container.appendChild(retryBtn);
            container.appendChild(rankingList);
            container.appendChild(resetBtn);
            quizEl.appendChild(container);
          }
        }, 100);
      };

      // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’ä¸­å¤®ã«é…ç½®ã™ã‚‹ãŸã‚ã®ãƒ©ãƒƒãƒ‘ãƒ¼
      const nextButtonWrapper = document.createElement("div");
      nextButtonWrapper.style.textAlign = "center";
      nextButtonWrapper.appendChild(nextButton);

  
      //ã€Œè§£ç­”ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸæ™‚ã®å‡¦ç†ã€‚
      // æ­£èª¤åˆ¤å®šã‚’è¡Œã„ã€çµæœã¨è§£èª¬ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

      button.onclick = () => {
        const selected = container.querySelector("input:checked"); // é¸æŠã•ã‚ŒãŸãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’å–å¾—
        if (!selected) {
          result.textContent = "é¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚";
          result.style.color = "black";
          return;
        }
        const isCorrect = parseInt(selected.value) === q.answer; // æ­£èª¤ã‚’åˆ¤å®š

        // åŠ¹æœéŸ³è¦ç´ ã‚’å–å¾—
        const seCorrect = document.getElementById("se-correct");
        const seWrong = document.getElementById("se-wrong");

        if (isCorrect) {
          result.classList.add("correct");
          score++; // æ­£è§£ãªã‚‰ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—
          seCorrect.currentTime = 0;
          seCorrect.play(); // æ­£è§£éŸ³
        } else {
          result.classList.add("wrong");
          seWrong.currentTime = 0;
          seWrong.play(); // ä¸æ­£è§£éŸ³
        }

        // çµæœã¨è§£èª¬ã‚’è¡¨ç¤º
        result.textContent = isCorrect ? "â—‹ æ­£è§£ã§ã™ï¼" : `Ã— ä¸æ­£è§£ã§ã™ã€‚æ­£è§£ï¼š${q.options[q.answer]}`;
        result.style.color = isCorrect ? "green" : "red";
        explanation.innerHTML = q.explanation;

        // è§£ç­”å¾Œã¯é¸æŠè‚¢ã‚’ç„¡åŠ¹åŒ–
        const labels = container.querySelectorAll("label");
        labels.forEach(label => label.classList.add("disabled"));

        // ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
        button.style.display = "none"; // ã€Œè§£ç­”ã€ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
        nextButton.style.display = "inline-block"; // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
      };

      // ä½œæˆã—ãŸå„è¦ç´ ã‚’ã‚¯ã‚¤ã‚ºã‚³ãƒ³ãƒ†ãƒŠã«è¿½åŠ 
      container.appendChild(button);
      container.appendChild(result);
      container.appendChild(explanation);
      container.appendChild(nextButtonWrapper);
      container.appendChild(backButton);
      quizEl.appendChild(container);
    }


ãƒ»bgm
      BGMç”¨ã®audioè¦ç´ ã€‚

  const bgm = document.getElementById('bgm');

ãƒ»const bgmToggleBtn
      BGMã®å†ç”Ÿ/åœæ­¢ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãƒœã‚¿ãƒ³è¦ç´ ã€‚

  const bgmToggleBtn = document.getElementById('bgm-toggle');

  // BGMåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
  bgmToggleBtn.addEventListener('click', () => {
    if (!bgm.paused) { // BGMãŒå†ç”Ÿä¸­ãªã‚‰
      bgm.pause(); // åœæ­¢ã™ã‚‹
      bgmToggleBtn.textContent = 'â–¶ï¸ BGMã‚’å†é–‹';
    } else { // BGMãŒåœæ­¢ä¸­ãªã‚‰
      bgm.play(); // å†ç”Ÿã™ã‚‹
      bgmToggleBtn.textContent = 'â¸ï¸ BGMã‚’åœæ­¢';
  }
});
</script>